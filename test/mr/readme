https://enterprise-support.nvidia.com/s/article/physical-address-memory-region


使用物理地址内存区域 (PA-MR) 时，所使用的内存区域必须： 不可交换（固定） 物理内存中的连续地址空间 分配物理内存的一种方法是使用 Linux 大页面，它保留 不可交换的、连续的物理地址空间。 可以使用 mmap 系统调用来访问该内存。 有多种方法可以将返回的虚拟地址从 mmap 转换为物理地址。 使用物理内存区域并在发布请求时提供物理地址可以提高随机访问性能，因为不需要从虚拟地址到物理地址的转换


安全说明：使用PA-MR时，用户会绕过内存保护内核机制，如果使用不当可能会导致系统崩溃。 建议有经验且了解可能风险的用户使用此功能。 启用物理地址内存区域 出于安全原因，默认情况下，MLNX_OFED 中未启用 PA-MR。 应使用以下配置标志重新编译 MLNX_OFED 源：--with-pa-mr

注意：出于安全原因，只有启用了 CAP_SYS_RAWIO 功能的用户才能分配 PA-MR。 2. 创建分散聚集元素（sge），如下所示：


注意：内联接收功能要求 sge 包含有效的虚拟地址。 由于使用物理访问 MR 时情况并非如此，因此这些功能不应一起使用。 默认情况下，内联接收功能是禁用的，因此只要您不通过 ibv_exp_qp_init_attr 结构中的 max_inl_recv 字段显式启用它，就应该没问题


